# -*- coding: utf-8 -*-
"""RAINFALL_PREDICTION_THROUGH_MLR_04_04_22.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xseQUd7vNziyjh7aKYDkLzSqzkA0O1wS
"""

import pandas as pd
import numpy as np

data=pd.read_excel('/content/Kolkatta 2000 - 2014.xlsx')
data.head(50)

len(data)

x=data.iloc[-100:-1,4:9]
y=data.iloc[-100:-1,9]

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=0)

from sklearn.linear_model import LinearRegression
ml=LinearRegression()
ml.fit(x_train,y_train)

y_pred=ml.predict(x_test)
y_pred

ml.predict([[9.611111,9.000000,1017.5,0.6,95.97245]])

from sklearn.metrics import r2_score
r2_score(y_test,y_pred)

#plot the results
import matplotlib.pyplot as plt
plt.figure(figsize=(15,10))
plt.scatter(y_test,y_pred)
plt.xlabel('Actual')
plt.ylabel('Predicted')
plt.title('Actual vs Predicted')

diff_pred=pd.DataFrame({'Actual value':y_test,'Predicted value':y_pred,'Diff':y_test-y_pred})
diff_pred[0:20]